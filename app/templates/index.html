<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jumbo Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<!-- ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<aside class="sidebar">
    <div class="sidebar-brand">
        <span class="brand-icon">J</span>
        <span class="brand-text">Jumbo<span class="brand-thin">API</span></span>
    </div>

    <nav class="sidebar-nav">
        <a href="#" class="nav-item active" data-panel="basket">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
            Basket
        </a>
        <a href="#" class="nav-item" data-panel="lists">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/></svg>
            Lists
        </a>
        <a href="#" class="nav-item" data-panel="orders">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><polyline points="17 11 19 13 23 9"/></svg>
            Orders
        </a>
        <a href="#" class="nav-item" data-panel="actions">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>
            Actions
        </a>
        <a href="#" class="nav-item" data-panel="history">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            History
        </a>
        <a href="#" class="nav-item" data-panel="docs">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
            Docs
        </a>
        <a href="#" class="nav-item" data-panel="settings">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
            Settings
        </a>
    </nav>

    <div class="sidebar-footer">
        <div class="auth-badge" id="auth-badge">
            <span class="auth-dot offline" id="auth-dot"></span>
            <span id="auth-text">Offline</span>
        </div>
        <button class="btn btn-login" id="login-btn" onclick="showLoginModal()">Login</button>
    </div>
</aside>

<!-- ‚îÄ‚îÄ Main Content ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<main class="main">

    <!-- Top Bar -->
    <header class="topbar">
        <h1 id="page-title">Shopping Basket</h1>
        <div class="topbar-actions">
            <button class="btn btn-icon" onclick="refreshBasket()" title="Refresh basket">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>
            </button>
        </div>
    </header>

    <!-- ‚îÄ‚îÄ Basket Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel active" id="panel-basket">
        <div class="basket-summary" id="basket-summary">
            <div class="stat-card">
                <span class="stat-value" id="basket-count">‚Äì</span>
                <span class="stat-label">Items</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="basket-total">‚Äì</span>
                <span class="stat-label">Total</span>
            </div>
        </div>
        <div class="basket-list" id="basket-content">
            <div class="empty-state">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="empty-icon"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
                <p>Login to view your basket</p>
            </div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ Lists Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel" id="panel-lists">
        <div class="lists-summary" id="lists-summary">
            <div class="stat-card">
                <span class="stat-value" id="lists-count">‚Äì</span>
                <span class="stat-label">My Lists</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="lists-products">‚Äì</span>
                <span class="stat-label">Total Products</span>
            </div>
        </div>
        <div class="lists-container" id="lists-content">
            <div class="empty-state">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="empty-icon"><path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/></svg>
                <p>Login to view your lists</p>
            </div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ Orders Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel" id="panel-orders">
        <div class="orders-summary" id="orders-summary">
            <div class="stat-card">
                <span class="stat-value" id="orders-count">‚Äì</span>
                <span class="stat-label">Total Orders</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="receipts-count">‚Äì</span>
                <span class="stat-label">Store Receipts</span>
            </div>
        </div>
        
        <h3 class="section-subtitle">Online Orders</h3>
        <div class="orders-container" id="orders-content">
            <div class="empty-state">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="empty-icon"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><polyline points="17 11 19 13 23 9"/></svg>
                <p>Login to view your orders</p>
            </div>
        </div>
        
        <h3 class="section-subtitle" style="margin-top: 24px;">Store Receipts</h3>
        <div class="receipts-container" id="receipts-content">
            <div class="empty-state">
                <p>No receipts</p>
            </div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ Actions Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel" id="panel-actions">
        <div class="actions-grid">

            <div class="action-card">
                <div class="action-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>
                    <h3>Add Product</h3>
                </div>
                <div class="action-body">
                    <input type="text" id="add-sku" placeholder="SKU  (e.g. 67649PAK)" class="input">
                    <input type="number" id="add-quantity" placeholder="Qty" value="1" min="1" step="1" class="input input-sm">
                    <button onclick="addProduct()" class="btn btn-primary">Add to Basket</button>
                </div>
            </div>

            <div class="action-card">
                <div class="action-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/></svg>
                    <h3>Remove Product</h3>
                </div>
                <div class="action-body">
                    <input type="text" id="remove-sku" placeholder="SKU or Line ID" class="input">
                    <button onclick="removeProduct()" class="btn btn-danger">Remove</button>
                </div>
            </div>

            <div class="action-card">
                <div class="action-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="4" rx="1"/><rect x="3" y="12" width="18" height="4" rx="1"/><line x1="7" y1="20" x2="7" y2="20"/><line x1="12" y1="20" x2="12" y2="20"/><line x1="17" y1="20" x2="17" y2="20"/></svg>
                    <h3>Barcode Lookup</h3>
                </div>
                <div class="action-body">
                    <input type="text" id="barcode-input" placeholder="EAN barcode" class="input">
                    <button onclick="lookupBarcode()" class="btn btn-primary">Lookup</button>
                    <div id="barcode-result" class="result-box"></div>
                </div>
            </div>

            <div class="action-card">
                <div class="action-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                    <h3>Search by SKU</h3>
                </div>
                <div class="action-body">
                    <input type="text" id="search-sku" placeholder="Product SKU" class="input">
                    <button onclick="searchProduct()" class="btn btn-primary">Search</button>
                    <div id="search-result" class="result-box"></div>
                </div>
            </div>

        </div>
    </section>

    <!-- ‚îÄ‚îÄ History Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel" id="panel-history">
        <div class="history-list" id="history-content">
            <div class="empty-state"><p>No commands yet</p></div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ Docs Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel" id="panel-docs">
        <div class="docs-content">
            <h2>API Documentation</h2>
            <p class="docs-intro">Welcome to the Jumbo API. This API provides programmatic access to your Jumbo.com shopping basket, lists (lijstjes), product search, and more.</p>
            
            <div class="docs-grid">
                <a href="/docs" target="_blank" class="doc-card doc-card-primary">
                    <div class="doc-card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    </div>
                    <div>
                        <h3>Interactive API Explorer</h3>
                        <p>Try all endpoints directly in your browser with the Swagger UI. No code required ‚Äì perfect for testing and learning the API.</p>
                        <span class="doc-badge">Swagger/OpenAPI</span>
                    </div>
                </a>

                <a href="https://github.com/yourusername/jumbo-api/blob/main/API_README.md" target="_blank" class="doc-card">
                    <div class="doc-card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                    </div>
                    <div>
                        <h3>API Reference</h3>
                        <p>Complete API documentation with examples, authentication guides, and integration patterns.</p>
                        <span class="doc-badge">README.md</span>
                    </div>
                </a>
            </div>

            <div class="docs-section">
                <h3>üöÄ Quick Start</h3>
                <ol class="docs-list">
                    <li>Authenticate using <code>POST /api/login</code> or load saved cookies</li>
                    <li>Explore endpoints in the <a href="/docs" target="_blank">Swagger UI</a></li>
                    <li>View your basket with <code>GET /api/basket</code></li>
                    <li>Search products, manage lists, and more!</li>
                </ol>
            </div>

            <div class="docs-section">
                <h3>üìö Key Features</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>üõí Basket Management</strong>
                        <p>View, add, remove, and update quantities in your shopping basket</p>
                    </div>
                    <div class="feature-item">
                        <strong>üìù Shopping Lists</strong>
                        <p>Access all your lijstjes (shopping lists) with full product details</p>
                    </div>
                    <div class="feature-item">
                        <strong>üîç Product Search</strong>
                        <p>Search by SKU or barcode to find products instantly</p>
                    </div>
                    <div class="feature-item">
                        <strong>üîê Secure Auth</strong>
                        <p>Automated Selenium-based login with cookie persistence</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ Settings Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel" id="panel-settings">
        <div class="settings-content">
            <!-- üîê Login Credentials -->
            <div class="settings-group">
                <h3 class="settings-group-title">üîê Login Credentials</h3>
                <p class="settings-group-desc">Save your Jumbo.com credentials for automatic re-authentication when sessions expire.</p>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Email Address</span>
                        <span class="setting-desc">Your Jumbo.com account email</span>
                    </div>
                    <input type="email" id="setting-username" class="input" placeholder="your@email.com" autocomplete="username">
                </div>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Password</span>
                        <span class="setting-desc">Your Jumbo.com account password</span>
                    </div>
                    <input type="password" id="setting-password" class="input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
                </div>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label" id="credentials-status">No credentials saved</span>
                        <span class="setting-desc">Credentials are stored locally in a secure Docker volume</span>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-primary btn-sm" onclick="saveCredentials()">Save Credentials</button>
                        <button class="btn btn-danger btn-sm" onclick="removeCredentials()" id="remove-creds-btn" style="display:none;">Remove</button>
                    </div>
                </div>
            </div>

            <!-- üîç Barcode Lookup -->
            <div class="settings-group">
                <h3 class="settings-group-title">üîç Barcode Lookup</h3>
                <p class="settings-group-desc">Configure how barcodes are looked up and matched when scanning EAN codes.</p>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">OpenFoodFacts Fallback</span>
                        <span class="setting-desc">If barcode not found in Jumbo, query OpenFoodFacts and search by product name</span>
                    </div>
                    <input type="checkbox" id="setting-openfoodfacts" class="toggle" onchange="saveSetting('useOpenFoodFactsFallback', this.checked)">
                </label>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Max Product Candidates</span>
                        <span class="setting-desc">Number of products to check for EAN similarity (5-50, higher = more accurate but slower)</span>
                    </div>
                    <input type="number" id="setting-max-candidates" class="input input-sm" min="5" max="50" step="1" value="15" onchange="saveSetting('maxProductCandidates', parseInt(this.value))">
                </label>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Include Size/Volume in Search</span>
                        <span class="setting-desc">Add quantity to search (e.g., "Cola 1,5 l" vs "Cola") - helps find single items vs multi-packs</span>
                    </div>
                    <input type="checkbox" id="setting-quantity-search" class="toggle" onchange="saveSetting('useQuantityInSearch', this.checked)">
                </label>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Include Brand in Search</span>
                        <span class="setting-desc">Add brand to search (e.g., "Jumbo Cola" vs "Cola") - helps with brand-specific products</span>
                    </div>
                    <input type="checkbox" id="setting-brand-search" class="toggle" onchange="saveSetting('useBrandInSearch', this.checked)">
                </label>
            </div>

            <!-- üéØ EAN Matching Scores -->
            <div class="settings-group">
                <h3 class="settings-group-title">üéØ EAN Matching Scores</h3>
                <p class="settings-group-desc">Configure scoring thresholds for EAN barcode similarity matching (0-100 points).</p>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">10+ Matching Digits</span>
                        <span class="setting-desc">Score for 10 or more matching digits (e.g., 8718452829xxx)</span>
                    </div>
                    <input type="number" id="setting-ean-10" class="input input-sm" min="0" max="100" step="5" value="90" onchange="saveSetting('eanScore10Plus', parseInt(this.value))">
                </div>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">8-9 Matching Digits</span>
                        <span class="setting-desc">Score for 8-9 matching digits (medium confidence)</span>
                    </div>
                    <input type="number" id="setting-ean-8" class="input input-sm" min="0" max="100" step="5" value="70" onchange="saveSetting('eanScore8Plus', parseInt(this.value))">
                </div>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">6-7 Matching Digits</span>
                        <span class="setting-desc">Score for 6-7 matching digits (low confidence)</span>
                    </div>
                    <input type="number" id="setting-ean-6" class="input input-sm" min="0" max="100" step="5" value="50" onchange="saveSetting('eanScore6Plus', parseInt(this.value))">
                </div>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">4-5 Matching Digits</span>
                        <span class="setting-desc">Score for 4-5 matching digits (very low confidence)</span>
                    </div>
                    <input type="number" id="setting-ean-4" class="input input-sm" min="0" max="100" step="5" value="30" onchange="saveSetting('eanScore4Plus', parseInt(this.value))">
                </div>
            </div>

            <!-- üßæ Receipt Product Matching -->
            <div class="settings-group">
                <h3 class="settings-group-title">üßæ Receipt Product Matching</h3>
                <p class="settings-group-desc">Control how store receipt items are matched to catalog products.</p>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Enable Product Matching</span>
                        <span class="setting-desc">Search and match receipt items to Jumbo catalog products with images and details</span>
                    </div>
                    <input type="checkbox" id="setting-matching-enabled" class="toggle" onchange="saveSetting('productMatchingEnabled', this.checked)">
                </label>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Strict Matching</span>
                        <span class="setting-desc">Only show matches with high confidence (‚â•70%) to prevent wrong products</span>
                    </div>
                    <input type="checkbox" id="setting-strict" class="toggle" onchange="saveSetting('strictMatching', this.checked)">
                </label>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Confidence Threshold</span>
                        <span class="setting-desc">Minimum confidence score (0-100) required to show a product match</span>
                    </div>
                    <div class="setting-slider-wrap">
                        <input type="range" id="setting-threshold" min="0" max="100" step="5" class="setting-slider" oninput="updateThresholdLabel(this.value)" onchange="saveSetting('confidenceThreshold', parseInt(this.value))">
                        <span class="setting-slider-value" id="threshold-label">50</span>
                    </div>
                </div>
            </div>

            <!-- ‚öñÔ∏è Matching Weights -->
            <div class="settings-group">
                <h3 class="settings-group-title">‚öñÔ∏è Matching Weights</h3>
                <p class="settings-group-desc">Adjust how much each factor contributes to the match score (0-100 points each).</p>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Enable Price Matching</span>
                        <span class="setting-desc">Compare receipt price against catalog price</span>
                    </div>
                    <input type="checkbox" id="setting-price" class="toggle" onchange="saveSetting('usePriceMatching', this.checked)">
                </label>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Price Weight</span>
                        <span class="setting-desc">Maximum points awarded for price match (default: 40)</span>
                    </div>
                    <input type="number" id="setting-price-weight" class="input input-sm" min="0" max="100" step="5" value="40" onchange="saveSetting('priceMatchWeight', parseInt(this.value))">
                </div>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Enable Weight/Volume Matching</span>
                        <span class="setting-desc">Compare grams, millilitres, and litres from receipt</span>
                    </div>
                    <input type="checkbox" id="setting-weight" class="toggle" onchange="saveSetting('useWeightMatching', this.checked)">
                </label>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Weight/Volume Weight</span>
                        <span class="setting-desc">Maximum points awarded for weight/volume match (default: 30)</span>
                    </div>
                    <input type="number" id="setting-weight-weight" class="input input-sm" min="0" max="100" step="5" value="30" onchange="saveSetting('weightMatchWeight', parseInt(this.value))">
                </div>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Enable Name Matching</span>
                        <span class="setting-desc">Compare product name words for overlap</span>
                    </div>
                    <input type="checkbox" id="setting-name" class="toggle" onchange="saveSetting('useNameMatching', this.checked)">
                </label>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Name Weight</span>
                        <span class="setting-desc">Maximum points awarded for name similarity (default: 30)</span>
                    </div>
                    <input type="number" id="setting-name-weight" class="input input-sm" min="0" max="100" step="5" value="30" onchange="saveSetting('nameMatchWeight', parseInt(this.value))">
                </div>
            </div>

            <!-- üíæ Cache Settings -->
            <div class="settings-group">
                <h3 class="settings-group-title">üíæ Cache Settings</h3>
                <p class="settings-group-desc">Control caching behavior for faster lookups and consistent results.</p>

                <label class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Enable Barcode Cache</span>
                        <span class="setting-desc">Cache barcode lookups to avoid repeated searches - disable for always-fresh results</span>
                    </div>
                    <input type="checkbox" id="setting-barcode-cache" class="toggle" onchange="saveSetting('useBarcodeCache', this.checked)">
                </label>

                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Clear Match Cache</span>
                        <span class="setting-desc">Remove all cached results - items will be re-matched on next view</span>
                    </div>
                    <button class="btn btn-danger btn-sm" onclick="clearMatchCache()">Clear Cache</button>
                </div>
            </div>
        </div>
    </section>

</main>

<!-- ‚îÄ‚îÄ Login Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="modal-overlay" id="login-modal" onclick="if(event.target === this) hideLoginModal()">
    <div class="modal">
        <h2>Login to Jumbo</h2>
        <p class="modal-sub">Automated browser login ‚Äì takes ~8 seconds</p>
        <input type="email" id="login-username" placeholder="Email" class="input" autocomplete="username">
        <input type="password" id="login-password" placeholder="Password" class="input" autocomplete="current-password">
        <div id="login-status" class="login-status"></div>
        <div class="modal-actions">
            <button onclick="submitLogin()" class="btn btn-primary" id="submit-login-btn">Login</button>
            <button onclick="hideLoginModal()" class="btn btn-ghost">Cancel</button>
        </div>
    </div>
</div>
<!-- ‚îÄ‚îÄ List Detail Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="modal-overlay" id="list-detail-modal" onclick="if(event.target === this) hideListDetailModal()">
    <div class="modal modal-wide">
        <div class="modal-header">
            <h2 id="list-detail-title">List</h2>
            <button onclick="hideListDetailModal()" class="btn-close">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
        </div>
        <p class="modal-sub" id="list-detail-meta"></p>
        <div id="list-detail-content" class="list-detail-content">
            <div class="empty-state"><p>Loading...</p></div>
        </div>
        <div class="modal-actions">
            <button onclick="hideListDetailModal()" class="btn btn-ghost">Close</button>
        </div>
    </div>
</div>

<!-- ‚îÄ‚îÄ Order Detail Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="modal-overlay" id="order-detail-modal" onclick="if(event.target === this) hideOrderDetailModal()">
    <div class="modal modal-wide">
        <div class="modal-header">
            <h2 id="order-detail-title">Order</h2>
            <button onclick="hideOrderDetailModal()" class="btn-close">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
        </div>
        <p class="modal-sub" id="order-detail-meta"></p>
        <div id="order-detail-content" class="order-detail-content">
            <div class="empty-state"><p>Loading...</p></div>
        </div>
        <div class="modal-actions">
            <button onclick="hideOrderDetailModal()" class="btn btn-ghost">Close</button>
        </div>
    </div>
</div>

<!-- ‚îÄ‚îÄ Receipt Detail Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="modal-overlay" id="receipt-detail-modal" onclick="if(event.target === this) hideReceiptDetailModal()">
    <div class="modal modal-wide">
        <div class="modal-header">
            <h2 id="receipt-detail-title">Receipt</h2>
            <button onclick="hideReceiptDetailModal()" class="btn-close">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
        </div>
        <p class="modal-sub" id="receipt-detail-meta"></p>
        <div id="receipt-detail-content" class="receipt-detail-content">
            <div class="empty-state"><p>Loading...</p></div>
        </div>
        <div class="modal-actions">
            <button onclick="hideReceiptDetailModal()" class="btn btn-ghost">Close</button>
        </div>
    </div>
</div>

<!-- ‚îÄ‚îÄ Toast ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div id="notification" class="toast"></div>

<script>
window.onerror = function(msg, url, line, col, err) {
  fetch("/api/health", {method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({error:msg,url:url,line:line,col:col})}).catch(()=>{});
  document.title = "ERR: " + msg + " L" + line;
};
</script>
<script src="/static/app.js"></script>
</body>
</html>
